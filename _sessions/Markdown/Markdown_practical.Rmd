---
title: "Markdown"
author: "<table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'><col width='10%'><col width='10%'>
  <tr style='border:none'>
    <td style='display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none' nowrap>
      <font style='font-style:normal'>Reporting mit R</font><br>
      <a href='https://therbootcamp.github.io/RmR_2020Jun/'>
        <i class='fas fa-clock' style='font-size:.9em;' ></i>
      </a>
      <a href='https://therbootcamp.github.io'>
        <i class='fas fa-home' style='font-size:.9em;'></i>
      </a>
      <a href='mailto:therbootcamp@gmail.com'>
        <i class='fas fa-envelope' style='font-size: .9em;'></i>
      </a>
      <a href='https://www.linkedin.com/company/basel-r-bootcamp/'>
        <i class='fab fa-linkedin' style='font-size: .9em;'></i>
      </a>
      <a href='https://therbootcamp.github.io'>
        <font style='font-style:normal'>The R Bootcamp</font>
      </a>
    </td>
    <td style='width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none'>
      <img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
    </td>
  </tr></table>"
output:
  html_document:
    css: practical.css
    self_contained: no
---

<style>
pre code,  .md:not(.use-csslab) pre code {
  white-space: pre-wrap;
  }
</style>

```{r setup, echo = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(comment = NA, 
                      fig.width = 6, 
                      fig.height = 6,
                      fig.align = 'center',
                      echo = FALSE, 
                      eval = FALSE, 
                      warning = FALSE,
                      message = FALSE,
                      tidy.opts=list(width.cutoff=40))

# Lade Pakete
library(tidyverse)
library(knitr)
library(kableExtra)
library(lubridate)

# Lade Daten
airbnb <- read_csv('1_Data/airbnb.csv') 

```

<p align="center" width="100%">
  <img src="image/airbnb_banner.png" alt="Trulli" style="width:100%">
  <br>
  <font style="font-size:10px">adapted from <a href="https://news.airbnb.com/de/unterkunften-fur-covid-19-einsatzkrafte/">airbnb.com</a></font>
</p>


# {.tabset}

## Überblick

In diesem Practical machst du deine ersten Schritte mit R Markdown. 

Am Ende des Practicals wirst du wissen wie man:

1. Chunks erstellt und einstellt.
2. ...

## Aufgaben

### A - Setup

1. Öffne dein `TheRBootcamp` R Projekt. Es sollte die Ordner `1_Data`, `2_Assets`, und `3_Markdown` enthalten. 

2. Öffne ein neues RMarkdown Skript und wähle das Template "HTML" aus (siehe screenshot unten).

<p align="center" width="100%">
  <img src="image/markdown_menu.png" alt="Trulli" style="height:200px">
</p>

3. Trage als Titel `Bericht Berlin 2018/2019` ein.

3. Speichere das neue Markdown Skript unter dem Namen `markdown_practical.Rmd` im `3_Markdown` Ordner ab.

4. Lösche alles unterhalb des `setup` R chunks.

5. Lade die Pakete `tidyverse` und `lubridate` im `setup` chunk.

```{r, echo = T, eval = T}
# Lade Pakete
library(tidyverse)
library(lubridate)
```

6. Lade den `airbnb` Datensatz mit `read_csv()` ebenfalls im `setup` chunk mit Code unten.

```{r echo = TRUE, eval = F}
# Lade airbnb Datensatz
airbnb <- read_csv("../1_Data/airbnb.csv")
```

7. Verwende den Code unten um nur die beiden Jahre `2018` und `2019` aus den Daten auszuwählen und ein neues Objekt mit Namen `airbnb_1819` zu erstellen.

```{r echo = TRUE, eval  = TRUE}
# Wähle Jahre 2018 und 2019 aus
airbnb_1819 <- airbnb %>% 
  filter(Erstellungsdatum > "2018-01-01", 
         Erstellungsdatum < "2019-12-31")
```




### B - Präambel

1. Unter den `setup` chunk, setze eine Überschrift auf drittem level (`###`) mit Titel `Präambel`. 

````markdown
### Präambel
````

2. Unter die Überschrift setze den folgenden Text. 

````wrap
Dieser Bericht analysiert Veränderungen in den Neueinstellungen und den Preisen von AirBnB Objekten in Berlin, Deutschland. Er wurde zum Zwecke der Übung auf Basis öffentlich verfügbarer Daten erstellt und repräsentiert einzig die Position der Autoren. Es besteht keine Beziehung zu AirBnB.  
````

3. `Knitte` das Dokument. Sieht alles in Ordnung aus?  

### C - Neueinstellungen: Text pt. 1

1. Setze eine weitere Überschrift auf dritter Ebene (`###`) mit Titel `Neueinstellungen` und darunter eine Überschrift auf vierter Ebene (`####`) mit dem Titel `Entwicklung`.

````markdown
### Präambel
````

2. Füge nun diesn Text ein. Er enthält einige Werte, die du gleich durch in-line Code ersetzen wirst.

````wrap
Seit 02.01.2018 wurden in Berlin 5007 Airbnb Wohnungen eingestellt. Von diesen Wohnungn weisen aktuell 73% Verfügbarkeiten von durchschnittlich 47.5 Tagen für die nächsten 3 Monate auf.

Einstellungen von AirBnB Wohnungen haben im letzten Jahr stark zugenommen. Im Jahr 2019 wurden insgesamt 3274 neue Wohnungen eingestellt wohingegend im Jahr 2018 nur 1733 Wohnungen eingestellt wurden. Dies entspricht einem Zuwachs von 89%.
````

3. Tausche zunächst das Datum an zweiter Stelle im Text durch den folgenen in-line Code aus. Nicht vergessen, der Code muss innerhalb zweier Ticks gesetzt werden. Knitte das Dokument.  

````text
r min(airbnb_1819$Erstellungsdatum)
````

4. Jetzt sollte der Text ein Datum enthalten, welches aber noch nicht ganz richtig formatiert ist. Hier hilft die `strftime()` Funktion. Versuche den folgenden erwarteten in-line Code um das Datum in das richtige Format zu bringen.   

````text
r strftime(min(airbnb_1819$Erstellungsdatum), "%d.%m.%Y")
````
5. Als nächstes ersetze die Anzahl der Wohnungen durch `nrow(airbnb_1819)`. Nicht das `r` am Anfang vergessen. 

6. Ersetze nun Prozentsatz der Wohnungen durch `round(mean(airbnb_1819$Verfügbarkeit_90Tage > 0) * 100)` und die durchschnittliche Verfügbarkeit durch `round(mean(airbnb_1819$Verfügbarkeit_90Tage[airbnb_1819$Verfügbarkeit_90Tage>0]),1)`. Jetzt sollten alle Zahlen des ersten Paragraphen durch Code ersetzt worden sein. Überprüfe ob alles stimmt. 

7. Ersetze nun Prozentsatz der Wohnungen durch `round(mean(airbnb_1819$Verfügbarkeit_90Tage > 0) * 100)` und die durchschnittliche Verfügbarkeit durch `round(mean(airbnb_1819$Verfügbarkeit_90Tage[airbnb_1819$Verfügbarkeit_90Tage>0]),1)`. Jetzt sollten alle Zahlen des ersten Paragraphen durch Code ersetzt worden sein. Überprüfe ob alles stimmt. 

8. Im nächsten Paragraphen ersetze die ersten beiden Zahlen durch `n_2019 <- sum(year(airbnb_1819$Erstellungsdatum) == 2019); n_2019` und `n_2018 <- sum(year(airbnb_1819$Erstellungsdatum) == 2018); n_2018`. In diesen beiden Fällen siehst du, dass auch Zuweisungen in in-line Code möglich sind. 

9. Ersetze nun die Zuwachsangabe am Ende des Paragraphen durch `(round(n_2019/n_2018, 2) - 1)*100`, was , wie du siehst, auf die beiden zuvor im in-line Code definierten Objekte zurückgreift. Knitte das Dokument und überprüfe, ob nun alle Zahlen einwandfrei wiedergegeben werden.

10. Zuletzt verwende `**` um den gesamten zweiten Paragraphen Fett zu setzen. Setze hierfür einmal die zwei Sterne vor das erste und nach dem letzten Wort des Paragraphen. Nun alles wie im Zieldokument?

### D - Neueinstellungen: Grafikchunk pt. 1

1. Erstelle einen neuen R `chunk`. In den `chunk` kopiere den Code unten, welcher eine erste Version der ersten Abbildung im Bericht generiert. 

```R
# Plotte Häufigkeiten
ggplot(airbnb_1819 %>% 
         group_by(Jahr = year(Erstellungsdatum), 
                  Monat_tmp = month(Erstellungsdatum)) %>% 
         summarize(
           Monat = as_factor(paste(first(Jahr), first(Monat_tmp), sep = '-')),
           Wohnungen = n()), 
       aes(x = Monat, y = Wohnungen, fill = Jahr)) + 
  geom_bar(stat = 'identity', position = 'dodge') + 
  theme(legend.position = 'none',
        axis.text.x = element_text(angle = 45, hjust = 1)) 
```


### E - Neueinstellungen: Text pt. 2

### F - Neueinstellungen: Grafikchunk pt. 2


## Datensatz

Der [airbnb.csv](https://raw.githubusercontent.com/therbootcamp/RmR_2020Apr/master/_materials/case/airbnb.csv) Datensatz enthält Zahlen zu 9868 Berliner Airbnbs 


|Variable | Beschreibung |
|:-------------|:-------------------------------------|
|Preis| Preis pro Nacht|
 |Erstellungsdatum| Eröffnungsdatum des Airbnbs |
 |Unterkunftsart| Appartement, Loft, House, etc.|
 |Schlafplätze| Anzahl Schlafplätze |
 |Schlafzimmer| Anzahl Schlafzimmer |
 |Badezimmer| Anzahl Badezimmer |
 |Reinigungsgebühr| Reinigungsgebühr |
 |Verfügbarkeit_90Tage| |
 |Viertel| In welchem Viertel befindet sich das Airbnb |
 |Stadtteil| In welchem Stadtteil befindet sich das Airbnb |
 |Breitengrad| Breitengrad|
 |Längengrad| Längengrad |
 |Host_id| Host id |
 |Host_seit| Erfahrung des Hosts |
 |Host_antwortzeit| Host Antwortzeit|
 |Host_antwortrate| Host Antwortrate |
 |Host_superhost| Superhost Ja/Nein |
 |Host_anzahl| Anzahl Gäste |
 |Rating_gesamt| Gesamtrating |
 |Rating_genauigkeit| Genauigkeitsrating |
 |Rating_sauberkeit| Sauberkeitsrating |
 |Rating_checkin| Checkinrating |
 |Rating_kommunikation| Kommunikationsrating |
 |Rating_lage| Lagerating |
 |Rating_wertigkeit| Wertigkeitsrating |
 |Küche| Küche vorhanden TRUE/FALSE |
 |Wifi| WLAN vorhanden TRUE/FALSE |
 |TV| TV vorhanden TRUE/FALSE |
 |Kaffeemaschine| Kaffeemaschine vorhanden TRUE/FALSE|
 |Geschirrspüler| Geschirrspüler vorhanden TRUE/FALSE|
 |Terrasse_Balkon| Terrasse/Balkon vorhanden TRUE/FALSE|
 |Badewanne| Badewanne vorhanden TRUE/FALSE|
 |Check_in_24h| 24h Check-In vorhanden TRUE/FALSE|



## Funktionen

### Paket

|Paket| Installation|
|:------|:------|
|`tidyverse`|`install.packages("tidyverse")`|


### Funktionen


| Funktion| Paket | Beschreibung |
|:---|:------|:---------------------------------------------|
| `gauge()`|`flexdashboard`| Erstelle einen gauge. | 



## Materialien


